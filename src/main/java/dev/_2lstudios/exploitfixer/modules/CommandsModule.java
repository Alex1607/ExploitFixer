package dev._2lstudios.exploitfixer.modules;

import java.util.Collection;
import java.util.regex.Pattern;

import dev._2lstudios.exploitfixer.configuration.IConfiguration;

public class CommandsModule implements IPunishmentModule {
	private static final Pattern SYNTAX_PATTERN = Pattern.compile("[\\w]{1,}:");

	private Collection<String> commands;
	private Collection<String> punishments;
	private String name;
	private boolean enabled;

	public void reload(final IConfiguration configYml) {
		this.name = "Commands";
		this.enabled = configYml.getBoolean("commands.enabled");
		this.commands = configYml.getStringList("commands.commands");
		this.punishments = configYml.getStringList("commands.punishments");
	}

	@Override
	final public boolean isEnabled() {
		return enabled;
	}

	@Override
	public String getName() {
		return name;
	}

	public final boolean isCommand(final String rawMessage) {
		if (rawMessage != null) {
			final String message = SYNTAX_PATTERN.matcher(rawMessage).replaceAll("").toLowerCase();

			for (final String command : commands) {
				if (message.startsWith(command)) {
					return true;
				}
			}
		}

		return false;
	}

	public final Collection<String> getPunishments() {
		return punishments;
	}
}
