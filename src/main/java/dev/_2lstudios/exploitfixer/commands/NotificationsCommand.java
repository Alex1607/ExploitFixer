package dev._2lstudios.exploitfixer.commands;

import org.bukkit.command.Command;
import org.bukkit.command.CommandExecutor;
import org.bukkit.command.CommandSender;
import org.bukkit.entity.Player;

import dev._2lstudios.exploitfixer.modules.MessagesModule;
import dev._2lstudios.exploitfixer.modules.NotificationsModule;

public class NotificationsCommand implements CommandExecutor {
    private final NotificationsModule notificationsModule;
    private final MessagesModule messagesModule;
    private final String lang;

    public NotificationsCommand(final NotificationsModule notificationsModule, final MessagesModule messagesModule, final String lang) {
        this.notificationsModule = notificationsModule;
        this.messagesModule = messagesModule;
        this.lang = lang;
    }

    @Override
    public boolean onCommand(final CommandSender sender, final Command command, final String label, final String[] args) {
        if (sender instanceof Player) {
            if (sender.hasPermission("exploitfixer.admin")
                    || sender.hasPermission("exploitfixer.notifications")) {
                final String playerName = sender.getName();

                if (!notificationsModule.isNotifications(playerName)) {
                    notificationsModule.setNotifications(playerName, true);
                    sender.sendMessage(messagesModule.getEnable(lang));
                } else {
                    notificationsModule.setNotifications(playerName, false);
                    sender.sendMessage(messagesModule.getDisable(lang));
                }
            } else {
                sender.sendMessage(messagesModule.getPermission(lang));
            }
        } else {
            sender.sendMessage(messagesModule.getConsole(lang));
        }

        return true;
    }
}
